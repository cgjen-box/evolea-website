---
/**
 * PageCloser - Premium prism gradient section before footer
 *
 * Features:
 * - Bold animated prism gradient background
 * - Large floating blurred orbs (mint, gold, pink, purple)
 * - Subtle floating butterflies
 * - Smooth gradient transition to footer
 * - Optional CTA content
 */
import Butterfly from './Butterfly.astro';

interface Props {
  showCTA?: boolean;
  ctaTitle?: string;
  ctaDescription?: string;
  ctaButtonText?: string;
  ctaButtonHref?: string;
  secondaryButtonText?: string;
  secondaryButtonHref?: string;
  secondaryButtonStyle?: 'instagram' | 'default';
}

const {
  showCTA = false,
  ctaTitle,
  ctaDescription,
  ctaButtonText,
  ctaButtonHref,
  secondaryButtonText,
  secondaryButtonHref,
  secondaryButtonStyle = 'default',
} = Astro.props;
---

<section class="page-closer" aria-hidden={!showCTA}>
  <!-- Bold Animated Prism Gradient Background -->
  <div class="page-closer-bg"></div>

  <!-- Large Floating Orbs with Radial Gradients -->
  <div class="floating-orbs" aria-hidden="true">
    <div class="orb orb-mint"></div>
    <div class="orb orb-gold"></div>
    <div class="orb orb-pink"></div>
    <div class="orb orb-purple"></div>
    <div class="orb orb-teal"></div>
  </div>

  <!-- Floating Butterflies -->
  <div class="floating-butterflies" aria-hidden="true">
    <div class="butterfly-float butterfly-1">
      <Butterfly size="md" variant="spectrum" />
    </div>
    <div class="butterfly-float butterfly-2">
      <Butterfly size="sm" variant="white" />
    </div>
    <div class="butterfly-float butterfly-3">
      <Butterfly size="lg" variant="spectrum" />
    </div>
    <div class="butterfly-float butterfly-4">
      <Butterfly size="sm" variant="white" />
    </div>
  </div>

  <!-- Optional CTA Content -->
  {showCTA && ctaTitle && (
    <div class="page-closer-content">
      <h2 class="page-closer-title">{ctaTitle}</h2>
      {ctaDescription && (
        <p class="page-closer-description">{ctaDescription}</p>
      )}
      <div class="page-closer-buttons">
        {ctaButtonText && ctaButtonHref && (
          <a href={ctaButtonHref} class="page-closer-btn">
            {ctaButtonText}
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        )}
        {secondaryButtonText && secondaryButtonHref && (
          <a href={secondaryButtonHref} class:list={["page-closer-btn-secondary", secondaryButtonStyle === 'instagram' && 'instagram-style']} target={secondaryButtonStyle === 'instagram' ? '_blank' : undefined} rel={secondaryButtonStyle === 'instagram' ? 'noopener noreferrer' : undefined}>
            {secondaryButtonStyle === 'instagram' && (
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z" clip-rule="evenodd" />
              </svg>
            )}
            {secondaryButtonText}
          </a>
        )}
      </div>
    </div>
  )}

  <!-- Smooth Wave Transition to Footer -->
  <div class="wave-to-footer"></div>
</section>

<style>
  .page-closer {
    position: relative;
    min-height: 350px;
    overflow: hidden;
  }

  /* ===== BOLD ANIMATED PRISM GRADIENT ===== */
  .page-closer-bg {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg,
      #4ECDC4 0%,      /* Bold teal */
      #FFE066 18%,     /* Sunshine */
      #FF9ECC 36%,     /* Soft pink */
      #E97BF1 54%,     /* Magenta */
      #CD87F8 72%,     /* Lavender */
      #9B3D9B 100%     /* Deep purple */
    );
    background-size: 400% 400%;
    animation: prismShift 20s ease infinite;
  }

  @keyframes prismShift {
    0%, 100% {
      background-position: 0% 50%;
    }
    25% {
      background-position: 50% 100%;
    }
    50% {
      background-position: 100% 50%;
    }
    75% {
      background-position: 50% 0%;
    }
  }

  /* ===== FLOATING ORBS ===== */
  .floating-orbs {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
  }

  .orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0.7;
    animation: orbFloat 20s ease-in-out infinite;
  }

  .orb-mint {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, #4ECDC4 0%, #3DB8AC 100%);
    top: -10%;
    left: -5%;
    animation-delay: 0s;
  }

  .orb-gold {
    width: 350px;
    height: 350px;
    background: radial-gradient(circle, #FFE066 0%, #FFC83D 100%);
    top: 20%;
    left: 25%;
    animation-delay: -5s;
  }

  .orb-pink {
    width: 450px;
    height: 450px;
    background: radial-gradient(circle, #FF6B9D 0%, #E84C82 100%);
    top: -15%;
    right: -10%;
    animation-delay: -10s;
  }

  .orb-purple {
    width: 380px;
    height: 380px;
    background: radial-gradient(circle, #CD87F8 0%, #B56FE8 100%);
    bottom: -20%;
    right: 20%;
    animation-delay: -15s;
  }

  .orb-teal {
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, #5DADE2 0%, #3498DB 100%);
    bottom: 10%;
    left: 15%;
    animation-delay: -8s;
  }

  @keyframes orbFloat {
    0%, 100% {
      transform: translate(0, 0) scale(1);
    }
    25% {
      transform: translate(40px, -40px) scale(1.08);
    }
    50% {
      transform: translate(-30px, 30px) scale(0.92);
    }
    75% {
      transform: translate(25px, 15px) scale(1.04);
    }
  }

  /* ===== FLOATING BUTTERFLIES ===== */
  .floating-butterflies {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
  }

  .butterfly-float {
    position: absolute;
    animation: butterflyDrift 25s ease-in-out infinite;
  }

  .butterfly-1 {
    top: 15%;
    left: 8%;
    opacity: 0.5;
    animation-delay: 0s;
  }

  .butterfly-2 {
    top: 55%;
    right: 12%;
    opacity: 0.3;
    animation-delay: -8s;
  }

  .butterfly-3 {
    bottom: 25%;
    left: 35%;
    opacity: 0.4;
    animation-delay: -16s;
  }

  .butterfly-4 {
    top: 30%;
    right: 30%;
    opacity: 0.25;
    animation-delay: -12s;
  }

  @keyframes butterflyDrift {
    0%, 100% {
      transform: translate(0, 0) rotate(0deg);
    }
    25% {
      transform: translate(60px, -50px) rotate(12deg);
    }
    50% {
      transform: translate(25px, 40px) rotate(-8deg);
    }
    75% {
      transform: translate(-40px, -25px) rotate(10deg);
    }
  }

  /* ===== CTA CONTENT ===== */
  .page-closer-content {
    position: relative;
    z-index: 10;
    text-align: center;
    padding: 6rem 2rem;
    max-width: 800px;
    margin: 0 auto;
  }

  .page-closer-title {
    font-family: 'Fredoka', sans-serif;
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 700;
    color: #FFFFFF;
    margin-bottom: 1rem;
    text-shadow:
      0 2px 4px rgba(0, 0, 0, 0.1),
      0 8px 30px rgba(138, 61, 158, 0.4),
      0 0 60px rgba(186, 83, 173, 0.3);
  }

  .page-closer-description {
    font-family: 'Poppins', sans-serif;
    font-size: 1.25rem;
    color: rgba(255, 255, 255, 0.95);
    margin-bottom: 2rem;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
  }

  .page-closer-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: #FFFFFF;
    color: #9B3D9B;
    font-family: 'Fredoka', sans-serif;
    font-weight: 600;
    font-size: 1.125rem;
    padding: 1.25rem 2.5rem;
    border-radius: 100px;
    text-decoration: none;
    box-shadow:
      0 4px 20px rgba(0, 0, 0, 0.15),
      0 0 40px rgba(255, 255, 255, 0.3);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .page-closer-btn:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow:
      0 8px 30px rgba(0, 0, 0, 0.2),
      0 0 60px rgba(255, 255, 255, 0.4);
  }

  .page-closer-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
    align-items: center;
  }

  .page-closer-btn-secondary {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    color: #FFFFFF;
    font-family: 'Fredoka', sans-serif;
    font-weight: 600;
    font-size: 1.125rem;
    padding: 1.25rem 2rem;
    border-radius: 100px;
    text-decoration: none;
    border: 2px solid rgba(255, 255, 255, 0.4);
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .page-closer-btn-secondary:hover {
    transform: translateY(-4px) scale(1.02);
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.6);
  }

  .page-closer-btn-secondary.instagram-style {
    background: linear-gradient(135deg, #833AB4, #FD1D1D, #F77737);
    border: none;
    box-shadow: 0 4px 20px rgba(131, 58, 180, 0.4);
  }

  .page-closer-btn-secondary.instagram-style:hover {
    box-shadow: 0 8px 30px rgba(131, 58, 180, 0.5);
  }

  /* ===== WAVE TO FOOTER ===== */
  .wave-to-footer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 120px;
    background: linear-gradient(
      180deg,
      transparent 0%,
      rgba(138, 61, 126, 0.5) 50%,
      #8A3D7E 100%
    );
  }

  /* ===== RESPONSIVE ===== */
  @media (min-width: 1024px) {
    .page-closer {
      min-height: 450px;
    }
  }

  @media (min-width: 1920px) {
    .page-closer {
      min-height: 550px;
    }

    .orb-mint { width: 500px; height: 500px; }
    .orb-gold { width: 450px; height: 450px; }
    .orb-pink { width: 550px; height: 550px; }
    .orb-purple { width: 480px; height: 480px; }
    .orb-teal { width: 400px; height: 400px; }
  }

  /* ===== REDUCED MOTION ===== */
  @media (prefers-reduced-motion: reduce) {
    .page-closer-bg {
      animation: none;
      background-position: 50% 50%;
    }

    .orb {
      animation: none;
    }

    .butterfly-float {
      animation: none;
    }

    .page-closer-btn {
      transition: none;
    }
  }
</style>
