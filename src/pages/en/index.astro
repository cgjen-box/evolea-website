---
import Base from '@layouts/Base.astro';
import VideoHero from '@components/VideoHero.astro';
import AngeboteSection from '@components/AngeboteSection.astro';
import PageCloser from '@components/PageCloser.astro';
import FloatingShapes from '@components/FloatingShapes.astro';
import Icon from '@components/Icon.astro';
import { getLangFromUrl, useTranslations, useTranslatedPath } from '@i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);
const base = import.meta.env.BASE_URL.replace(/\/$/, '');

// Values for English version
const values = [
  {
    iconName: 'shield' as const,
    title: t('values.safety.title'),
    description: t('values.safety.desc'),
    color: 'magenta',
  },
  {
    iconName: 'sparkle' as const,
    title: t('values.empower.title'),
    description: t('values.empower.desc'),
    color: 'coral',
  },
  {
    iconName: 'diamond' as const,
    title: t('values.potential.title'),
    description: t('values.potential.desc'),
    color: 'mint',
  },
];

const colorClasses: Record<string, string> = {
  magenta: 'bg-evolea-magenta/10 border-evolea-magenta',
  coral: 'bg-evolea-coral/10 border-evolea-coral',
  mint: 'bg-evolea-mint/10 border-evolea-mint',
};

// Programs data for AngeboteSection
const programs = [
  {
    title: t('programs.miniGarten'),
    description: t('programs.miniGarten.desc'),
    href: translatePath('/angebote/mini-garten/'),
    iconName: 'sprout' as const,
    imageSrc: base + '/images/programs/garden.jpg',
    imageAlt: 'Children learning through play in the garden',
    colorAccent: 'mint' as const,
  },
  {
    title: t('programs.miniProjekte'),
    description: t('programs.miniProjekte.desc'),
    href: translatePath('/angebote/mini-projekte/'),
    iconName: 'palette' as const,
    imageSrc: base + '/images/programs/projects.jpg',
    imageAlt: 'Children engaged in creative projects',
    colorAccent: 'coral' as const,
  },
  {
    title: t('programs.miniTurnen'),
    description: t('programs.miniTurnen.desc'),
    href: translatePath('/angebote/mini-turnen/'),
    iconName: 'ball' as const,
    imageSrc: base + '/images/programs/sports.png',
    imageAlt: 'Children doing sports and gymnastics',
    colorAccent: 'sky' as const,
  },
  {
    title: t('programs.schulberatung'),
    description: t('programs.schulberatung.desc'),
    href: translatePath('/angebote/schulberatung/'),
    iconName: 'school' as const,
    imageSrc: base + '/images/programs/school.jpg',
    imageAlt: 'School consultation and support',
    colorAccent: 'magenta' as const,
  },
];
---

<Base
  title="Home"
  description="EVOLEA Verein - Educational programs for children on the autism spectrum or with ADHD in Zürich. Mini Garden, Mini Projects, Mini Sports and School Consultation."
  transparentHeader={true}
>
  <!-- Hero Section with Video Background -->
  <VideoHero
    title={t('hero.title')}
    subtitle={t('hero.subtitle')}
    videoSrc={base + "/videos/hero.mp4"}
    posterSrc={base + "/images/hero-poster.jpg"}
    primaryButtonText={t('hero.cta.primary')}
    primaryButtonHref={translatePath('/angebote/')}
    secondaryButtonText={t('hero.cta.secondary')}
    secondaryButtonHref={translatePath('/kontakt/')}
  />

  <!-- About / Mission Section -->
  <section class="section-padding relative overflow-hidden">
    <FloatingShapes variant="section" />

    <div class="container mx-auto max-w-6xl relative z-10">
      <div class="grid lg:grid-cols-2 gap-12 items-center">
        <!-- Text content -->
        <div class="reveal">
          <span class="section-label">{t('about.title')}</span>
          <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold text-evolea-magenta mb-6 leading-tight">
            <span class="doodle-underline">{t('about.subtitle')}</span>
          </h2>
          <p class="text-lg text-evolea-text-light leading-relaxed mb-8">
            {t('about.description')}
          </p>
          <a href={translatePath('/ueber-uns/')} class="btn-primary">
            {t('about.cta')}
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </a>
        </div>

        <!-- Visual element / Stats - Glassmorphism cards -->
        <div class="reveal reveal-delay-2">
          <div class="grid grid-cols-2 gap-4">
            <div class="stat-card group">
              <div class="stat-number text-evolea-coral">4+</div>
              <div class="stat-label">Programs</div>
            </div>
            <div class="stat-card group">
              <div class="stat-number text-evolea-mint">3-8</div>
              <div class="stat-label">Years</div>
            </div>
            <div class="stat-card group">
              <div class="stat-number text-evolea-purple-light">ZH</div>
              <div class="stat-label">Zürich</div>
            </div>
            <div class="stat-card-featured group">
              <div class="stat-number-featured">100%</div>
              <div class="stat-label-featured">Individualized</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Programs Section - Premium Redesigned -->
  <AngeboteSection
    sectionLabel={t('nav.programs')}
    title={t('programs.title')}
    subtitle={t('programs.subtitle')}
    programs={programs}
    learnMoreText="Learn more"
  />

  <!-- Values Section -->
  <section class="section-padding relative overflow-hidden">
    <FloatingShapes variant="minimal" />

    <div class="container mx-auto max-w-6xl relative z-10">
      <div class="section-header reveal">
        <span class="section-label">{t('values.title')}</span>
        <h2>{t('values.title')}</h2>
      </div>

      <div class="grid md:grid-cols-3 gap-6">
        {values.map((value, index) => (
          <div
            class:list={[
              'reveal p-6 rounded-evolea-lg border-l-4 transition-all hover:shadow-soft bg-white',
              colorClasses[value.color],
            ]}
            style={`animation-delay: ${index * 0.1}s`}
          >
            <div class="flex items-start gap-4">
              <div class="flex-shrink-0">
                <Icon name={value.iconName} size="lg" />
              </div>
              <div>
                <h3 class="font-display font-bold text-evolea-purple text-lg mb-2">
                  {value.title}
                </h3>
                <p class="text-evolea-text-light text-sm leading-relaxed">
                  {value.description}
                </p>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Spectrum line decoration -->
    <div class="container mx-auto max-w-4xl mt-16">
      <div class="spectrum-line reveal"></div>
    </div>
  </section>

  <!-- Team Preview Section -->
  <section class="section-padding bg-white relative">
    <div class="container mx-auto max-w-4xl text-center">
      <div class="reveal">
        <span class="section-label">{t('nav.team')}</span>
        <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold text-evolea-magenta mb-6">
          {t('team.title')}
        </h2>
        <p class="text-lg text-evolea-text-light mb-8 max-w-2xl mx-auto">
          {t('team.description')}
        </p>
        <a href={translatePath('/team/')} class="btn-secondary">
          {t('team.cta')}
          <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Page Closer - Prism Gradient with Floating Elements -->
  <PageCloser
    showCTA={true}
    ctaTitle={t('contact.title')}
    ctaDescription={t('contact.subtitle')}
    ctaButtonText={t('contact.cta')}
    ctaButtonHref={translatePath('/kontakt/')}
  />
</Base>
