# Cloudflare Pages configuration for EVOLEA Website
name = "evolea-website"
pages_build_output_dir = "./dist"

# Build command that installs @astrojs/cloudflare adapter before building
# This is needed because the adapter doesn't install on Windows ARM64 (local dev)
# so it's not in package-lock.json
command = "npm run build:cloudflare"

# Use a recent compatibility date to enable process.env support
compatibility_date = "2025-04-01"

# Enable Node.js compatibility - this makes process.env work at runtime
# which is required for Keystatic to read KEYSTATIC_SECRET, etc.
# See: https://developers.cloudflare.com/workers/runtime-apis/nodejs/process/
# With compatibility_date >= 2025-04-01 and nodejs_compat, process.env is populated automatically
compatibility_flags = ["nodejs_compat"]

# Explicitly enable process.env population (should be auto-enabled with date >= 2025-04-01)
# This ensures environment variables are available via process.env at runtime
# See: https://developers.cloudflare.com/workers/configuration/compatibility-dates/

# Environment variables for local development
# Production values should be set in Cloudflare Dashboard
[vars]
NODE_ENV = "production"

# For local development, create a .dev.vars file with:
# KEYSTATIC_GITHUB_CLIENT_ID=your_client_id
# KEYSTATIC_GITHUB_CLIENT_SECRET=your_client_secret
# KEYSTATIC_SECRET=your_secret
